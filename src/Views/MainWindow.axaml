<Window x:Class="X4PlayerShipTradeAnalyzer.Views.MainWindow"
        xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:conv="clr-namespace:X4PlayerShipTradeAnalyzer.Converters"
        xmlns:lvc="clr-namespace:LiveChartsCore.SkiaSharpView.Avalonia;assembly=LiveChartsCore.SkiaSharpView.Avalonia"
        xmlns:mdv="clr-namespace:MarkdownViewer.Core.Controls;assembly=MarkdownViewer.Core"
        xmlns:vm="clr-namespace:X4PlayerShipTradeAnalyzer.ViewModels"
        Title="X4 Player Ship Trade Analyzer"
        Width="1200"
        Height="800">
  <Window.Resources>
    <conv:NullToUnsetBrushConverter x:Key="NullToUnsetBrush" />
    <conv:ZeroToRedBrushConverter x:Key="ZeroToRed" />
    <conv:ZeroToRedIfEnabledConverter x:Key="ZeroToRedIfEnabled" />
    <conv:EnumEqualsConverter x:Key="EnumEquals" />
    <conv:BoolToChartPositionConverter x:Key="BoolToChartPos" />
    <conv:LoadPercentToBrushConverter x:Key="LoadPercentToBrushConverter" />
  </Window.Resources>
  <Window.Styles>
    <Style Selector="TextBlock.RightAligned">
      <Setter Property="TextAlignment" Value="Right" />
      <Setter Property="HorizontalAlignment" Value="Right" />
    </Style>
    <Style Selector="TextBlock.RightAlignedPadded">
      <Setter Property="TextAlignment" Value="Right" />
      <Setter Property="HorizontalAlignment" Value="Right" />
      <Setter Property="Padding" Value="8" />
    </Style>
  </Window.Styles>

  <Design.DataContext>
    <vm:MainViewModel baseDir="." />
  </Design.DataContext>

  <TabControl x:Name="MainTabs"
              Grid.Row="1"
              SelectionChanged="MainTabs_SelectionChanged">
    <!--  Parent: By Transactions  -->
    <TabItem x:Name="ByTransactionsTab" Header="By Transactions">
      <TabControl x:Name="ByTransactionsTabs">
        <TabItem x:Name="TransactionsTab" Header="Ships Transactions">
          <Grid DataContext="{Binding TransactionsData}">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="Auto" />
              <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
              <RowDefinition Height="36" />
              <RowDefinition Height="36" />
              <RowDefinition />
              <RowDefinition Height="34" />
            </Grid.RowDefinitions>

            <Border Grid.Row="0"
                    Grid.Column="0"
                    Width="340"
                    Padding="0"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <StackPanel Margin="0"
                          HorizontalAlignment="Left"
                          Orientation="Horizontal"
                          Spacing="6">
                <TextBlock VerticalAlignment="Center" Text="Parent station:" />
                <ComboBox Width="240"
                          VerticalAlignment="Center"
                          ItemsSource="{Binding Stations}"
                          SelectedItem="{Binding SelectedStation}">
                  <ComboBox.ItemTemplate>
                    <DataTemplate>
                      <TextBlock Text="{Binding Name}" ToolTip.Tip="{Binding Name}" />
                    </DataTemplate>
                  </ComboBox.ItemTemplate>
                </ComboBox>
              </StackPanel>
            </Border>

            <Border Grid.Row="1"
                    Grid.Column="0"
                    Padding="0"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <StackPanel Margin="0"
                          HorizontalAlignment="Left"
                          Orientation="Horizontal"
                          Spacing="6">
                <TextBlock Margin="8,0,0,0"
                           VerticalAlignment="Center"
                           Text="Class:" />
                <ComboBox Width="70"
                          VerticalAlignment="Center"
                          ItemsSource="{Binding ShipClassOptions}"
                          SelectedItem="{Binding SelectedShipClass}" />
                <TextBlock VerticalAlignment="Center" Text="Transport:" />
                <ComboBox Width="150"
                          VerticalAlignment="Center"
                          ItemsSource="{Binding TransportOptions}"
                          SelectedItem="{Binding Transport}" />
              </StackPanel>
            </Border>

            <Border Grid.Row="2"
                    Grid.Column="0"
                    Padding="0"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <ListBox Width="340"
                       Margin="8"
                       ItemsSource="{Binding ShipList}"
                       SelectedItem="{Binding SelectedShip, Mode=TwoWay}">
                <ListBox.ItemTemplate>
                  <DataTemplate>
                    <Grid ColumnDefinitions="*,8,Auto">
                      <TextBlock Grid.Column="0"
                                 Text="{Binding ShipName}"
                                 ToolTip.Tip="{Binding ShipName}" />
                      <TextBlock Grid.Column="2"
                                 Margin="0"
                                 Classes="RightAligned"
                                 FontWeight="SemiBold"
                                 Text="{Binding EstimatedProfit, StringFormat=N2}" />
                    </Grid>
                  </DataTemplate>
                </ListBox.ItemTemplate>
              </ListBox>
            </Border>
            <Border Grid.Row="3"
                    Grid.Column="0"
                    Padding="0"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <StackPanel Margin="0"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center"
                          Orientation="Horizontal"
                          Spacing="4">
                <TextBlock VerticalAlignment="Center" Text="Sort:" />
                <RadioButton Margin="8,0,0,0"
                             Content="Name"
                             GroupName="ShipsSort"
                             IsChecked="{Binding ShipsSortOrder, Mode=TwoWay, Converter={StaticResource EnumEquals}, ConverterParameter=Name}" />
                <RadioButton Margin="8,0,0,0"
                             Content="Profit"
                             GroupName="ShipsSort"
                             IsChecked="{Binding ShipsSortOrder, Mode=TwoWay, Converter={StaticResource EnumEquals}, ConverterParameter=Profit}" />
              </StackPanel>
            </Border>

            <!--  Row 0, Column 1: summary values  -->
            <Border Grid.Row="0"
                    Grid.Column="1"
                    Padding="4"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <StackPanel HorizontalAlignment="Left"
                          VerticalAlignment="Center"
                          Orientation="Horizontal"
                          Spacing="24">
                <StackPanel Orientation="Horizontal" Spacing="6">
                  <TextBlock Text="Ship:" />
                  <TextBlock FontWeight="Bold" Text="{Binding SelectedShip.ShipName}" />
                </StackPanel>
                <StackPanel Orientation="Horizontal" Spacing="6">
                  <TextBlock Text="Total Profit:" />
                  <TextBlock FontWeight="Bold" Text="{Binding TotalProfit}" />
                </StackPanel>
                <StackPanel Orientation="Horizontal" Spacing="6">
                  <TextBlock Text="Items Traded:" />
                  <TextBlock FontWeight="Bold" Text="{Binding ItemsTraded}" />
                </StackPanel>
                <StackPanel Orientation="Horizontal" Spacing="6">
                  <TextBlock Text="Time in Service:" />
                  <TextBlock FontWeight="Bold" Text="{Binding TimeInService}" />
                </StackPanel>
                <StackPanel Orientation="Horizontal" Spacing="6">
                  <TextBlock Text="Elapsed Time (Buyâ†’Sell):" />
                  <StackPanel Orientation="Horizontal" Spacing="6">
                    <TextBlock Text="Min:" />
                    <TextBlock FontWeight="Bold" Text="{Binding TimeMin}" />
                  </StackPanel>
                  <StackPanel Orientation="Horizontal" Spacing="6">
                    <TextBlock Text="Avg:" />
                    <TextBlock FontWeight="Bold" Text="{Binding TimeAvg}" />
                  </StackPanel>
                  <StackPanel Orientation="Horizontal" Spacing="6">
                    <TextBlock Text="Max:" />
                    <TextBlock FontWeight="Bold" Text="{Binding TimeMax}" />
                  </StackPanel>
                </StackPanel>
              </StackPanel>
            </Border>

            <Border Grid.Row="1"
                    Grid.RowSpan="3"
                    Grid.Column="1"
                    Padding="4"
                    BorderBrush="Gray"
                    BorderThickness="0">

              <DataGrid Margin="8"
                        AutoGenerateColumns="False"
                        IsReadOnly="True"
                        ItemsSource="{Binding FilteredTransactions}">
                <DataGrid.Columns>
                  <DataGridTemplateColumn Width="90"
                                          Header="Time"
                                          SortMemberPath="RawTime">
                    <DataGridTemplateColumn.CellTemplate>
                      <DataTemplate>
                        <TextBlock Classes="RightAlignedPadded" Text="{Binding Time}" />
                      </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                  </DataGridTemplateColumn>
                  <DataGridTemplateColumn Width="180"
                                          Header="Sector"
                                          SortMemberPath="Sector">
                    <DataGridTemplateColumn.CellTemplate>
                      <DataTemplate>
                        <TextBlock Margin="8"
                                   Text="{Binding Sector}"
                                   ToolTip.Tip="{Binding Sector}" />
                      </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                  </DataGridTemplateColumn>
                  <DataGridTemplateColumn Width="180"
                                          Header="Station"
                                          SortMemberPath="Station">
                    <DataGridTemplateColumn.CellTemplate>
                      <DataTemplate>
                        <TextBlock Margin="8"
                                   Text="{Binding Station}"
                                   ToolTip.Tip="{Binding Station}" />
                      </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                  </DataGridTemplateColumn>
                  <DataGridTextColumn Width="100"
                                      Binding="{Binding Operation}"
                                      Header="Operation" />
                  <DataGridTemplateColumn Width="140"
                                          Header="Product"
                                          SortMemberPath="Product">
                    <DataGridTemplateColumn.CellTemplate>
                      <DataTemplate>
                        <TextBlock Margin="8"
                                   Text="{Binding Product}"
                                   ToolTip.Tip="{Binding Product}" />
                      </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                  </DataGridTemplateColumn>
                  <DataGridTemplateColumn Width="100"
                                          Header="Price"
                                          SortMemberPath="Price">
                    <DataGridTemplateColumn.CellTemplate>
                      <DataTemplate>
                        <TextBlock Classes="RightAlignedPadded" Text="{Binding Price, StringFormat=N2}" />
                      </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                  </DataGridTemplateColumn>
                  <DataGridTemplateColumn Width="100"
                                          Header="Quantity"
                                          SortMemberPath="Quantity">
                    <DataGridTemplateColumn.CellTemplate>
                      <DataTemplate>
                        <TextBlock Classes="RightAlignedPadded" Text="{Binding Quantity, StringFormat=N0}" />
                      </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                  </DataGridTemplateColumn>
                  <DataGridTemplateColumn Width="90"
                                          Header="Load, %"
                                          SortMemberPath="LoadPercent">
                    <DataGridTemplateColumn.CellTemplate>
                      <DataTemplate>
                        <TextBlock Classes="RightAlignedPadded"
                                   Foreground="{Binding LoadPercent, Converter={StaticResource LoadPercentToBrushConverter}}"
                                   Text="{Binding LoadPercent, StringFormat=N2}" />
                      </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                  </DataGridTemplateColumn>
                  <DataGridTemplateColumn Width="140"
                                          Header="Total"
                                          SortMemberPath="Total">
                    <DataGridTemplateColumn.CellTemplate>
                      <DataTemplate>
                        <TextBlock Classes="RightAlignedPadded" Text="{Binding Total, StringFormat=N2}" />
                      </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                  </DataGridTemplateColumn>
                  <DataGridTemplateColumn Width="140"
                                          Header="Estimated Profit"
                                          SortMemberPath="EstimatedProfit">
                    <DataGridTemplateColumn.CellTemplate>
                      <DataTemplate>
                        <TextBlock Classes="RightAlignedPadded" Text="{Binding EstimatedProfit, StringFormat=N2}" />
                      </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                  </DataGridTemplateColumn>
                  <DataGridTemplateColumn Width="90"
                                          Header="Dist."
                                          SortMemberPath="Distance">
                    <DataGridTemplateColumn.CellTemplate>
                      <DataTemplate>
                        <TextBlock Classes="RightAlignedPadded" Text="{Binding Distance, StringFormat=N0}" />
                      </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                  </DataGridTemplateColumn>
                </DataGrid.Columns>
              </DataGrid>

            </Border>
          </Grid>
        </TabItem>

        <TabItem x:Name="TransactionsGraphsTab" Header="Ships Graphs">
          <Grid DataContext="{Binding TransactionsGraphs}">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="Auto" />
              <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
              <RowDefinition Height="36" />
              <RowDefinition Height="36" />
              <RowDefinition />
              <RowDefinition Height="34" />
            </Grid.RowDefinitions>

            <Border Grid.Row="0"
                    Grid.Column="0"
                    Width="340"
                    Padding="0"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <StackPanel Margin="0"
                          HorizontalAlignment="Left"
                          Orientation="Horizontal"
                          Spacing="6">
                <TextBlock VerticalAlignment="Center" Text="Parent station:" />
                <ComboBox Width="240"
                          VerticalAlignment="Center"
                          ItemsSource="{Binding Stations}"
                          SelectedItem="{Binding SelectedStation}">
                  <ComboBox.ItemTemplate>
                    <DataTemplate>
                      <TextBlock Text="{Binding Name}" ToolTip.Tip="{Binding Name}" />
                    </DataTemplate>
                  </ComboBox.ItemTemplate>
                </ComboBox>
              </StackPanel>
            </Border>

            <Border Grid.Row="1"
                    Grid.Column="0"
                    Padding="0"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <StackPanel Margin="0"
                          HorizontalAlignment="Left"
                          Orientation="Horizontal"
                          Spacing="6">
                <TextBlock Margin="8,0,0,0"
                           VerticalAlignment="Center"
                           Text="Class:" />
                <ComboBox Width="70"
                          VerticalAlignment="Center"
                          ItemsSource="{Binding ShipClassOptions}"
                          SelectedItem="{Binding SelectedShipClass}" />
                <TextBlock VerticalAlignment="Center" Text="Transport:" />
                <ComboBox Width="150"
                          VerticalAlignment="Center"
                          ItemsSource="{Binding TransportOptions}"
                          SelectedItem="{Binding Transport}" />
              </StackPanel>
            </Border>

            <Border Grid.Row="2"
                    Grid.Column="0"
                    Padding="0"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <ListBox Width="340"
                       Margin="8"
                       DoubleTapped="ShipGraphsList_DoubleTapped"
                       ItemsSource="{Binding ShipList}">
                <ListBox.ItemTemplate>
                  <DataTemplate>
                    <Grid ColumnDefinitions="*,8,Auto">
                      <TextBlock Grid.Column="0"
                                 FontWeight="{Binding FontWeight}"
                                 Foreground="{Binding GraphBrush, Converter={StaticResource NullToUnsetBrush}}"
                                 Text="{Binding ShipName}"
                                 ToolTip.Tip="{Binding ShipName}" />
                      <TextBlock Grid.Column="2"
                                 Margin="0"
                                 Classes="RightAligned"
                                 FontWeight="SemiBold"
                                 Text="{Binding EstimatedProfit, StringFormat=N2}" />
                    </Grid>
                  </DataTemplate>
                </ListBox.ItemTemplate>
              </ListBox>
            </Border>
            <Border Grid.Row="3"
                    Grid.Column="0"
                    Padding="0"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <StackPanel Margin="0"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center"
                          Orientation="Horizontal"
                          Spacing="4">
                <TextBlock VerticalAlignment="Center" Text="Sort:" />
                <RadioButton Margin="8,0,0,0"
                             Content="Name"
                             GroupName="ShipsSort"
                             IsChecked="{Binding ShipsSortOrder, Mode=TwoWay, Converter={StaticResource EnumEquals}, ConverterParameter=Name}" />
                <RadioButton Margin="8,0,0,0"
                             Content="Profit"
                             GroupName="ShipsSort"
                             IsChecked="{Binding ShipsSortOrder, Mode=TwoWay, Converter={StaticResource EnumEquals}, ConverterParameter=Profit}" />
              </StackPanel>
            </Border>
            <Border Grid.Row="0"
                    Grid.RowSpan="4"
                    Grid.Column="1"
                    Padding="8"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <lvc:CartesianChart Sections="{Binding Sections}"
                                  Series="{Binding Series}"
                                  XAxes="{Binding XAxes}"
                                  YAxes="{Binding YAxes}" />
            </Border>
          </Grid>
        </TabItem>
        <TabItem x:Name="TransactionsStatsShipsLoadTab" Header="Ships Load Distribution">
          <Grid DataContext="{Binding TransactionsStatsShipsLoad}">
            <Grid.RowDefinitions>
              <RowDefinition Height="34" />
              <RowDefinition />
            </Grid.RowDefinitions>
            <Grid Grid.Row="0" ColumnDefinitions="*,Auto">
              <StackPanel Grid.Column="0"
                          Margin="0"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center"
                          Orientation="Horizontal"
                          Spacing="4">
                <TextBlock VerticalAlignment="Center" Text="Transport:" />
                <RadioButton Content="All"
                             GroupName="TxLoadTransport"
                             IsChecked="{Binding Transport, Mode=TwoWay, Converter={StaticResource EnumEquals}, ConverterParameter=All}" />
                <RadioButton Content="Container"
                             GroupName="TxLoadTransport"
                             IsChecked="{Binding Transport, Mode=TwoWay, Converter={StaticResource EnumEquals}, ConverterParameter=Container}" />
                <RadioButton Content="Solid"
                             GroupName="TxLoadTransport"
                             IsChecked="{Binding Transport, Mode=TwoWay, Converter={StaticResource EnumEquals}, ConverterParameter=Solid}" />
                <RadioButton Content="Liquid"
                             GroupName="TxLoadTransport"
                             IsChecked="{Binding Transport, Mode=TwoWay, Converter={StaticResource EnumEquals}, ConverterParameter=Liquid}" />
              </StackPanel>
              <StackPanel Grid.Column="1"
                          Margin="0"
                          HorizontalAlignment="Right"
                          VerticalAlignment="Center"
                          Orientation="Horizontal"
                          Spacing="8">
                <TextBlock VerticalAlignment="Center" Text="Parent station:" />
                <ComboBox Width="240"
                          VerticalAlignment="Center"
                          ItemsSource="{Binding Stations}"
                          SelectedItem="{Binding SelectedStation}">
                  <ComboBox.ItemTemplate>
                    <DataTemplate>
                      <TextBlock Text="{Binding Name}" ToolTip.Tip="{Binding Name}" />
                    </DataTemplate>
                  </ComboBox.ItemTemplate>
                </ComboBox>
                <TextBlock VerticalAlignment="Center" Text="Class:" />
                <ComboBox Width="70"
                          ItemsSource="{Binding ShipClassOptions}"
                          SelectedItem="{Binding SelectedShipClass}" />
                <TextBlock VerticalAlignment="Center" Text="Top N Ships:" />
                <ComboBox ItemsSource="{Binding TopNOptions}" SelectedItem="{Binding TopN}" />
                <CheckBox VerticalAlignment="Center"
                          Content="Reverse Order"
                          IsChecked="{Binding ReverseSort}" />
              </StackPanel>
            </Grid>
            <Grid Grid.Row="1"
                  ColumnDefinitions="340,*"
                  RowDefinitions="*,34">
              <!--  Sidebar  -->
              <Border Grid.Row="0"
                      Grid.Column="0"
                      Width="340"
                      Padding="0"
                      BorderBrush="Gray"
                      BorderThickness="0">
                <Grid ColumnDefinitions="12,168,8,140,12" RowDefinitions="36,Auto,*">
                  <TextBlock Grid.Row="0"
                             Grid.Column="0"
                             Grid.ColumnSpan="5"
                             HorizontalAlignment="Center"
                             FontWeight="Bold"
                             Text="Selected Ship:" />
                  <TextBlock Grid.Row="1"
                             Grid.Column="1"
                             FontWeight="SemiBold"
                             Text="{Binding PressedShipName}"
                             ToolTip.Tip="{Binding PressedShipName}" />
                  <TextBlock Grid.Row="1"
                             Grid.Column="3"
                             Classes="RightAligned"
                             FontWeight="Bold"
                             Text="{Binding PressedShipTotal}" />
                  <ListBox Grid.Row="2"
                           Grid.Column="0"
                           Grid.ColumnSpan="5"
                           BorderThickness="0"
                           ItemsSource="{Binding ShipBucketsList}">
                    <ListBox.Styles>
                      <Style Selector="ListBoxItem">
                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                      </Style>
                    </ListBox.Styles>
                    <ListBox.ItemTemplate>
                      <DataTemplate>
                        <Grid ColumnDefinitions="4,168,8,140,4">
                          <TextBlock Grid.Column="1"
                                     Margin="0"
                                     FontWeight="{Binding FontWeight}"
                                     Foreground="{Binding GraphBrush, Converter={StaticResource NullToUnsetBrush}}"
                                     Text="{Binding Name}" />
                          <TextBlock Grid.Column="3"
                                     Margin="0"
                                     Classes="RightAligned"
                                     FontWeight="Bold"
                                     Foreground="{Binding GraphBrush, Converter={StaticResource NullToUnsetBrush}}"
                                     Text="{Binding Percent, StringFormat=N2}%" />
                        </Grid>
                      </DataTemplate>
                    </ListBox.ItemTemplate>
                  </ListBox>
                </Grid>
              </Border>
              <!--  Chart  -->
              <Border Grid.Row="0"
                      Grid.Column="1"
                      Padding="8"
                      BorderBrush="Gray"
                      BorderThickness="0">
                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                  <Border MinWidth="{Binding ChartMinWidth}">
                    <lvc:CartesianChart x:Name="TransactionsShipsLoadChart"
                                        LegendPosition="Hidden"
                                        Sections="{Binding Sections}"
                                        Series="{Binding Series}"
                                        TooltipPosition="{Binding ShowToolTip, Converter={StaticResource BoolToChartPos}}"
                                        XAxes="{Binding XAxes}"
                                        YAxes="{Binding YAxes}" />
                  </Border>
                </ScrollViewer>
              </Border>
              <Border Grid.Row="1"
                      Grid.Column="0"
                      Padding="0"
                      BorderBrush="Gray"
                      BorderThickness="0">
                <StackPanel HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Orientation="Horizontal"
                            Spacing="24">
                  <TextBlock Margin="0,0,8,0"
                             VerticalAlignment="Center"
                             Text="Display Tooltip:" />
                  <CheckBox VerticalAlignment="Center" IsChecked="{Binding ShowToolTip}" />
                </StackPanel>
              </Border>
            </Grid>
          </Grid>
        </TabItem>
        <TabItem x:Name="TransactionsStatsShipsWaresTab" Header="Ships by Wares Stats">
          <Grid DataContext="{Binding TransactionsStatsShipsWares}">
            <Grid.RowDefinitions>
              <RowDefinition Height="34" />
              <RowDefinition />
            </Grid.RowDefinitions>
            <!--  Filters row  -->
            <Border Grid.Row="0"
                    Padding="4"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <Grid Grid.ColumnDefinitions="*,Auto">
                <StackPanel Grid.Column="0"
                            Margin="0"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Orientation="Horizontal"
                            Spacing="4">
                  <TextBlock VerticalAlignment="Center" Text="Transport:" />
                  <RadioButton Content="All"
                               GroupName="TxTransport"
                               IsChecked="{Binding Transport, Mode=TwoWay, Converter={StaticResource EnumEquals}, ConverterParameter=All}" />
                  <RadioButton Content="Container"
                               GroupName="TxTransport"
                               IsChecked="{Binding Transport, Mode=TwoWay, Converter={StaticResource EnumEquals}, ConverterParameter=Container}" />
                  <RadioButton Content="Solid"
                               GroupName="TxTransport"
                               IsChecked="{Binding Transport, Mode=TwoWay, Converter={StaticResource EnumEquals}, ConverterParameter=Solid}" />
                  <RadioButton Content="Liquid"
                               GroupName="TxTransport"
                               IsChecked="{Binding Transport, Mode=TwoWay, Converter={StaticResource EnumEquals}, ConverterParameter=Liquid}" />
                </StackPanel>
                <StackPanel Grid.Column="1"
                            Margin="0"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            Orientation="Horizontal"
                            Spacing="8">
                  <TextBlock VerticalAlignment="Center" Text="Parent station:" />
                  <ComboBox Width="240"
                            VerticalAlignment="Center"
                            ItemsSource="{Binding Stations}"
                            SelectedItem="{Binding SelectedStation}">
                    <ComboBox.ItemTemplate>
                      <DataTemplate>
                        <TextBlock Text="{Binding Name}" ToolTip.Tip="{Binding Name}" />
                      </DataTemplate>
                    </ComboBox.ItemTemplate>
                  </ComboBox>
                  <TextBlock VerticalAlignment="Center" Text="Class:" />
                  <ComboBox Width="70"
                            ItemsSource="{Binding ShipClassOptions}"
                            SelectedItem="{Binding SelectedShipClass}" />
                  <TextBlock VerticalAlignment="Center" Text="Top N Ships:" />
                  <ComboBox ItemsSource="{Binding TopNOptions}" SelectedItem="{Binding TopN}" />
                  <CheckBox VerticalAlignment="Center"
                            Content="Reverse Order"
                            IsChecked="{Binding ReverseSort}" />
                </StackPanel>
              </Grid>
            </Border>
            <!--  Chart + custom legend  -->
            <Grid Grid.Row="1"
                  ColumnDefinitions="340, *"
                  RowDefinitions="Auto,*,34">
              <Border Grid.Row="0"
                      Grid.Column="0"
                      Width="340"
                      Padding="0"
                      BorderBrush="Gray"
                      BorderThickness="0">
                <Grid ColumnDefinitions="12,168,8,140,12" RowDefinitions="36, Auto">
                  <TextBlock Grid.Row="0"
                             Grid.Column="0"
                             Grid.ColumnSpan="5"
                             HorizontalAlignment="Center"
                             FontWeight="Bold"
                             Text="Selected Ship:" />
                  <TextBlock Grid.Row="1"
                             Grid.Column="1"
                             FontWeight="SemiBold"
                             Text="{Binding PressedShipName}"
                             ToolTip.Tip="{Binding PressedShipName}" />
                  <TextBlock Grid.Row="1"
                             Grid.Column="3"
                             Classes="RightAligned"
                             FontWeight="Bold"
                             Text="{Binding PressedShipTotal}" />
                </Grid>
              </Border>
              <Border Grid.Row="1"
                      Grid.Column="0"
                      Padding="4"
                      BorderBrush="Gray"
                      BorderThickness="0">
                <ListBox Width="340"
                         Margin="0"
                         Background="Transparent"
                         ItemsSource="{Binding ShipWaresList}">
                  <ListBox.ItemTemplate>
                    <DataTemplate>
                      <Grid ColumnDefinitions="*,8,Auto">
                        <TextBlock Grid.Column="0"
                                   FontWeight="SemiBold"
                                   Foreground="{Binding GraphBrush, Converter={StaticResource NullToUnsetBrush}}"
                                   Text="{Binding Name}"
                                   ToolTip.Tip="{Binding Name}" />
                        <TextBlock Grid.Column="2"
                                   Margin="0"
                                   Classes="RightAligned"
                                   FontWeight="Bold"
                                   Foreground="{Binding GraphBrush, Converter={StaticResource NullToUnsetBrush}}"
                                   Text="{Binding Money, StringFormat=N2}" />
                      </Grid>
                    </DataTemplate>
                  </ListBox.ItemTemplate>
                </ListBox>
              </Border>
              <Border Grid.Row="2"
                      Grid.Column="0"
                      Padding="0"
                      BorderBrush="Gray"
                      BorderThickness="0">
                <StackPanel HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Orientation="Horizontal"
                            Spacing="24">
                  <TextBlock Margin="0,0,8,0"
                             VerticalAlignment="Center"
                             Text="Display Tooltip:" />
                  <CheckBox VerticalAlignment="Center" IsChecked="{Binding ShowToolTip}" />
                </StackPanel>
              </Border>
              <Border Grid.Row="0"
                      Grid.RowSpan="3"
                      Grid.Column="1"
                      Padding="8"
                      BorderBrush="Gray"
                      BorderThickness="0">
                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                  <Border MinWidth="{Binding ChartMinWidth}">
                    <lvc:CartesianChart x:Name="TransactionsShipsByWaresChart"
                                        Grid.Column="0"
                                        LegendPosition="Hidden"
                                        Sections="{Binding Sections}"
                                        Series="{Binding Series}"
                                        TooltipPosition="{Binding ShowToolTip, Converter={StaticResource BoolToChartPos}}"
                                        XAxes="{Binding XAxes}"
                                        YAxes="{Binding YAxes}" />
                  </Border>
                </ScrollViewer>
              </Border>
            </Grid>
          </Grid>
        </TabItem>
        <TabItem x:Name="TransactionsStatsWaresShipsTab" Header="Wares by Ships Stats">
          <Grid DataContext="{Binding TransactionsStatsWaresShips}">
            <Grid.RowDefinitions>
              <RowDefinition Height="34" />
              <RowDefinition />
            </Grid.RowDefinitions>
            <!--  Filters row  -->
            <Border Grid.Row="0"
                    Padding="4"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <Grid Grid.ColumnDefinitions="*,Auto">
                <StackPanel Grid.Column="0"
                            Margin="0"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Orientation="Horizontal"
                            Spacing="4">
                  <TextBlock VerticalAlignment="Center" Text="Transport:" />
                  <RadioButton Content="All"
                               GroupName="TxTransport"
                               IsChecked="{Binding Transport, Mode=TwoWay, Converter={StaticResource EnumEquals}, ConverterParameter=All}" />
                  <RadioButton Content="Container"
                               GroupName="TxTransport"
                               IsChecked="{Binding Transport, Mode=TwoWay, Converter={StaticResource EnumEquals}, ConverterParameter=Container}" />
                  <RadioButton Content="Solid"
                               GroupName="TxTransport"
                               IsChecked="{Binding Transport, Mode=TwoWay, Converter={StaticResource EnumEquals}, ConverterParameter=Solid}" />
                  <RadioButton Content="Liquid"
                               GroupName="TxTransport"
                               IsChecked="{Binding Transport, Mode=TwoWay, Converter={StaticResource EnumEquals}, ConverterParameter=Liquid}" />
                </StackPanel>
                <StackPanel Grid.Column="1"
                            Margin="0"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            Orientation="Horizontal"
                            Spacing="8">
                  <TextBlock VerticalAlignment="Center" Text="Parent station:" />
                  <ComboBox Width="240"
                            VerticalAlignment="Center"
                            ItemsSource="{Binding Stations}"
                            SelectedItem="{Binding SelectedStation}">
                    <ComboBox.ItemTemplate>
                      <DataTemplate>
                        <TextBlock Text="{Binding Name}" ToolTip.Tip="{Binding Name}" />
                      </DataTemplate>
                    </ComboBox.ItemTemplate>
                  </ComboBox>
                  <TextBlock VerticalAlignment="Center" Text="Class:" />
                  <ComboBox Width="70"
                            ItemsSource="{Binding ShipClassOptions}"
                            SelectedItem="{Binding SelectedShipClass}" />
                  <TextBlock VerticalAlignment="Center" Text="Top N Wares:" />
                  <ComboBox ItemsSource="{Binding TopNOptions}" SelectedItem="{Binding TopN}" />
                  <CheckBox VerticalAlignment="Center"
                            Content="Reverse Order"
                            IsChecked="{Binding ReverseSort}" />
                </StackPanel>
              </Grid>
            </Border>
            <!--  Chart + custom legend  -->
            <Grid Grid.Row="1"
                  ColumnDefinitions="340, *"
                  RowDefinitions="Auto,*,34">
              <Border Grid.Row="0"
                      Grid.Column="0"
                      Width="340"
                      Padding="0"
                      BorderBrush="Gray"
                      BorderThickness="0">
                <Grid ColumnDefinitions="12,168,8,140,12" RowDefinitions="36, Auto">
                  <TextBlock Grid.Row="0"
                             Grid.Column="0"
                             Grid.ColumnSpan="5"
                             HorizontalAlignment="Center"
                             FontWeight="Bold"
                             Text="Selected Ware:" />
                  <TextBlock Grid.Row="1"
                             Grid.Column="1"
                             FontWeight="SemiBold"
                             Text="{Binding PressedWareName}"
                             ToolTip.Tip="{Binding PressedWareName}" />
                  <TextBlock Grid.Row="1"
                             Grid.Column="3"
                             Classes="RightAligned"
                             FontWeight="Bold"
                             Text="{Binding PressedWareTotal}" />
                </Grid>
              </Border>
              <Border Grid.Row="1"
                      Grid.Column="0"
                      Padding="4"
                      BorderBrush="Gray"
                      BorderThickness="0">
                <ListBox Width="340"
                         Margin="0"
                         Background="Transparent"
                         ItemsSource="{Binding WareShipsList}">
                  <ListBox.ItemTemplate>
                    <DataTemplate>
                      <Grid ColumnDefinitions="*,8,Auto">
                        <TextBlock Grid.Column="0"
                                   FontWeight="SemiBold"
                                   Foreground="{Binding GraphBrush, Converter={StaticResource NullToUnsetBrush}}"
                                   Text="{Binding ShipName}"
                                   ToolTip.Tip="{Binding ShipName}" />
                        <TextBlock Grid.Column="2"
                                   Margin="0"
                                   Classes="RightAligned"
                                   FontWeight="Bold"
                                   Foreground="{Binding GraphBrush, Converter={StaticResource NullToUnsetBrush}}"
                                   Text="{Binding EstimatedProfit, StringFormat=N2}" />
                      </Grid>
                    </DataTemplate>
                  </ListBox.ItemTemplate>
                </ListBox>
              </Border>
              <Border Grid.Row="2"
                      Grid.Column="0"
                      Padding="0"
                      BorderBrush="Gray"
                      BorderThickness="0">
                <StackPanel HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Orientation="Horizontal"
                            Spacing="24">
                  <TextBlock Margin="0,0,8,0"
                             VerticalAlignment="Center"
                             Text="Display Tooltip:" />
                  <CheckBox VerticalAlignment="Center" IsChecked="{Binding ShowToolTip}" />
                </StackPanel>
              </Border>
              <Border Grid.Row="0"
                      Grid.RowSpan="3"
                      Grid.Column="1"
                      Padding="8"
                      BorderBrush="Gray"
                      BorderThickness="0">
                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                  <Border MinWidth="{Binding ChartMinWidth}">
                    <lvc:CartesianChart x:Name="TransactionsWaresByShipsChart"
                                        Grid.Column="0"
                                        LegendPosition="Hidden"
                                        Sections="{Binding Sections}"
                                        Series="{Binding Series}"
                                        TooltipPosition="{Binding ShowToolTip, Converter={StaticResource BoolToChartPos}}"
                                        XAxes="{Binding XAxes}"
                                        YAxes="{Binding YAxes}" />
                  </Border>
                </ScrollViewer>
              </Border>
            </Grid>
          </Grid>
        </TabItem>
      </TabControl>
    </TabItem>

    <!--  Parent: By Trades  -->
    <TabItem x:Name="ByTradesTab" Header="By Trades">
      <TabControl x:Name="ByTradesTabs">
        <TabItem x:Name="TradesTab" Header="Ships Trades">
          <Grid DataContext="{Binding TradesData}">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="Auto" />
              <ColumnDefinition Width="Auto" />
              <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
              <RowDefinition Height="36" />
              <RowDefinition Height="36" />
              <RowDefinition />
              <RowDefinition Height="34" />
            </Grid.RowDefinitions>

            <Border Grid.Row="0"
                    Grid.Column="0"
                    Width="340"
                    Padding="0"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <StackPanel Margin="0"
                          HorizontalAlignment="Left"
                          Orientation="Horizontal"
                          Spacing="6">
                <TextBlock VerticalAlignment="Center" Text="Parent station:" />
                <ComboBox Width="240"
                          VerticalAlignment="Center"
                          ItemsSource="{Binding Stations}"
                          SelectedItem="{Binding SelectedStation}">
                  <ComboBox.ItemTemplate>
                    <DataTemplate>
                      <TextBlock Text="{Binding Name}" ToolTip.Tip="{Binding Name}" />
                    </DataTemplate>
                  </ComboBox.ItemTemplate>
                </ComboBox>
              </StackPanel>
            </Border>

            <Border Grid.Row="1"
                    Grid.Column="0"
                    Padding="0"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <StackPanel Margin="0"
                          HorizontalAlignment="Left"
                          Orientation="Horizontal"
                          Spacing="6">
                <TextBlock Margin="8,0,0,0"
                           VerticalAlignment="Center"
                           Text="Class:" />
                <ComboBox Width="70"
                          VerticalAlignment="Center"
                          ItemsSource="{Binding ShipClassOptions}"
                          SelectedItem="{Binding SelectedShipClass}" />

                <CheckBox Margin="48,0,0,0"
                          Content="With Internal Trades"
                          IsChecked="{Binding WithInternalTrades, Mode=TwoWay}" />
              </StackPanel>
            </Border>

            <!--  Left: ships list  -->
            <Border Grid.Row="2"
                    Grid.Column="0"
                    Padding="0"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <ListBox Width="340"
                       Margin="8"
                       ItemsSource="{Binding ShipList}"
                       SelectedItem="{Binding SelectedShip, Mode=TwoWay}">
                <ListBox.ItemTemplate>
                  <DataTemplate>
                    <Grid ColumnDefinitions="*,8,Auto">
                      <TextBlock Grid.Column="0"
                                 Text="{Binding ShipName}"
                                 ToolTip.Tip="{Binding ShipName}" />
                      <TextBlock Grid.Column="2"
                                 Margin="0"
                                 Classes="RightAligned"
                                 FontWeight="SemiBold"
                                 Text="{Binding EstimatedProfit, StringFormat=N2}" />
                    </Grid>
                  </DataTemplate>
                </ListBox.ItemTemplate>
              </ListBox>
            </Border>

            <Border Grid.Row="3"
                    Grid.Column="0"
                    Padding="0"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <StackPanel Grid.Column="0"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center"
                          Orientation="Horizontal"
                          Spacing="6">
                <TextBlock VerticalAlignment="Center" Text="Sort:" />
                <RadioButton Margin="8,0,0,0"
                             Content="Name"
                             GroupName="ShipsSort"
                             IsChecked="{Binding ShipsSortOrder, Mode=TwoWay, Converter={StaticResource EnumEquals}, ConverterParameter=Name}" />
                <RadioButton Margin="8,0,0,0"
                             Content="Profit"
                             GroupName="ShipsSort"
                             IsChecked="{Binding ShipsSortOrder, Mode=TwoWay, Converter={StaticResource EnumEquals}, ConverterParameter=Profit}" />
              </StackPanel>
            </Border>
            <!--  Filters / summary row  -->
            <Border Grid.Row="0"
                    Grid.Column="1"
                    Grid.ColumnSpan="2"
                    Padding="4"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <StackPanel HorizontalAlignment="Left"
                          Orientation="Horizontal"
                          Spacing="24">
                <StackPanel Orientation="Horizontal" Spacing="6">
                  <TextBlock Text="Ship:" />
                  <TextBlock FontWeight="Bold" Text="{Binding SelectedShip.ShipName}" />
                </StackPanel>
                <StackPanel Orientation="Horizontal" Spacing="6">
                  <TextBlock Text="Total Profit:" />
                  <TextBlock FontWeight="Bold" Text="{Binding TotalProfit}" />
                </StackPanel>
                <StackPanel Orientation="Horizontal" Spacing="6">
                  <TextBlock Text="Items Traded:" />
                  <TextBlock FontWeight="Bold" Text="{Binding ItemsTraded}" />
                </StackPanel>
                <StackPanel Orientation="Horizontal" Spacing="6">
                  <TextBlock Text="Time in Service:" />
                  <TextBlock FontWeight="Bold" Text="{Binding TimeInService}" />
                </StackPanel>
                <StackPanel Orientation="Horizontal" Spacing="6">
                  <TextBlock Text="Trade Time:" />
                  <StackPanel Orientation="Horizontal" Spacing="6">
                    <TextBlock Text="Min:" />
                    <TextBlock FontWeight="Bold" Text="{Binding TimeMin}" />
                  </StackPanel>
                  <StackPanel Orientation="Horizontal" Spacing="6">
                    <TextBlock Text="Avg:" />
                    <TextBlock FontWeight="Bold" Text="{Binding TimeAvg}" />
                  </StackPanel>
                  <StackPanel Orientation="Horizontal" Spacing="6">
                    <TextBlock Text="Max:" />
                    <TextBlock FontWeight="Bold" Text="{Binding TimeMax}" />
                  </StackPanel>
                </StackPanel>
              </StackPanel>
            </Border>

            <!--  Middle: full trades grid  -->
            <Border Grid.Row="1"
                    Grid.RowSpan="2"
                    Grid.Column="1"
                    Padding="4"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <DataGrid Margin="8"
                        AutoGenerateColumns="False"
                        IsReadOnly="True"
                        ItemsSource="{Binding FilteredFullTrades}"
                        SelectedItem="{Binding SelectedFullTrade, Mode=TwoWay}">
                <DataGrid.Columns>
                  <DataGridTemplateColumn Width="90"
                                          Header="Time"
                                          SortMemberPath="EndTime">
                    <DataGridTemplateColumn.CellTemplate>
                      <DataTemplate>
                        <TextBlock Classes="RightAlignedPadded" Text="{Binding Time}" />
                      </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                  </DataGridTemplateColumn>
                  <DataGridTextColumn Width="200"
                                      Binding="{Binding Product}"
                                      Header="Product" />
                  <DataGridTemplateColumn Width="90"
                                          Header="Quantity"
                                          SortMemberPath="BoughtQuantity">
                    <DataGridTemplateColumn.CellTemplate>
                      <DataTemplate>
                        <TextBlock Classes="RightAlignedPadded" Text="{Binding BoughtQuantity, StringFormat=N0}" />
                      </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                  </DataGridTemplateColumn>
                  <DataGridTemplateColumn Width="90"
                                          Header="Load, %"
                                          SortMemberPath="LoadPercent">
                    <DataGridTemplateColumn.CellTemplate>
                      <DataTemplate>
                        <TextBlock Classes="RightAlignedPadded"
                                   Foreground="{Binding LoadPercent, Converter={StaticResource LoadPercentToBrushConverter}}"
                                   Text="{Binding LoadPercent, StringFormat=N2}" />
                      </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                  </DataGridTemplateColumn>
                  <DataGridTemplateColumn Width="120"
                                          Header="Profit"
                                          SortMemberPath="Profit">
                    <DataGridTemplateColumn.CellTemplate>
                      <DataTemplate>
                        <TextBlock Classes="RightAlignedPadded" Text="{Binding Profit, StringFormat=N2}" />
                      </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                  </DataGridTemplateColumn>
                  <DataGridTemplateColumn Width="90"
                                          Header="Spent Time"
                                          SortMemberPath="SpentTime">
                    <DataGridTemplateColumn.CellTemplate>
                      <DataTemplate>
                        <TextBlock Classes="RightAlignedPadded" Text="{Binding SpentTime}" />
                      </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                  </DataGridTemplateColumn>
                  <DataGridTemplateColumn Width="90"
                                          Header="Dist."
                                          SortMemberPath="Distance">
                    <DataGridTemplateColumn.CellTemplate>
                      <DataTemplate>
                        <TextBlock Classes="RightAlignedPadded" Text="{Binding Distance, StringFormat=N0}" />
                      </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                  </DataGridTemplateColumn>
                </DataGrid.Columns>
              </DataGrid>
            </Border>

            <!--  Right: combined steps grid  -->
            <Border Grid.Row="1"
                    Grid.RowSpan="2"
                    Grid.Column="2"
                    Padding="4"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <DataGrid Margin="8"
                        AutoGenerateColumns="False"
                        IsReadOnly="True"
                        ItemsSource="{Binding TradeSteps}">
                <DataGrid.Columns>
                  <DataGridTemplateColumn Width="90"
                                          Header="Time"
                                          SortMemberPath="TimeRaw">
                    <DataGridTemplateColumn.CellTemplate>
                      <DataTemplate>
                        <TextBlock Classes="RightAlignedPadded" Text="{Binding Time}" />
                      </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                  </DataGridTemplateColumn>
                  <DataGridTextColumn Width="60"
                                      Binding="{Binding Operation}"
                                      Header="Op." />
                  <DataGridTemplateColumn Width="80"
                                          Header="Qnt."
                                          SortMemberPath="Volume">
                    <DataGridTemplateColumn.CellTemplate>
                      <DataTemplate>
                        <TextBlock Classes="RightAlignedPadded" Text="{Binding Volume, StringFormat=N0}" />
                      </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                  </DataGridTemplateColumn>
                  <DataGridTemplateColumn Width="80"
                                          Header="Price"
                                          SortMemberPath="Price">
                    <DataGridTemplateColumn.CellTemplate>
                      <DataTemplate>
                        <TextBlock Classes="RightAlignedPadded" Text="{Binding Price, StringFormat=N2}" />
                      </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                  </DataGridTemplateColumn>
                  <DataGridTemplateColumn Width="90"
                                          Header="Dist."
                                          SortMemberPath="Distance">
                    <DataGridTemplateColumn.CellTemplate>
                      <DataTemplate>
                        <TextBlock Classes="RightAlignedPadded" Text="{Binding Distance, StringFormat=N0}" />
                      </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                  </DataGridTemplateColumn>
                  <DataGridTemplateColumn Width="140"
                                          Header="Sector"
                                          SortMemberPath="Sector">
                    <DataGridTemplateColumn.CellTemplate>
                      <DataTemplate>
                        <TextBlock Margin="8"
                                   Text="{Binding Sector}"
                                   ToolTip.Tip="{Binding Sector}" />
                      </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                  </DataGridTemplateColumn>
                  <DataGridTemplateColumn Width="Auto"
                                          Header="Station"
                                          SortMemberPath="Station">
                    <DataGridTemplateColumn.CellTemplate>
                      <DataTemplate>
                        <TextBlock Margin="8"
                                   Text="{Binding Station}"
                                   ToolTip.Tip="{Binding Station}" />
                      </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                  </DataGridTemplateColumn>
                </DataGrid.Columns>
              </DataGrid>
            </Border>
          </Grid>
        </TabItem>
        <TabItem x:Name="TradesGraphsTab" Header="Ships Graphs">
          <Grid DataContext="{Binding TradesGraphs}">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="Auto" />
              <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
              <RowDefinition Height="36" />
              <RowDefinition Height="36" />
              <RowDefinition />
              <RowDefinition Height="34" />
            </Grid.RowDefinitions>
            <Border Grid.Row="0"
                    Grid.Column="0"
                    Width="340"
                    Padding="0"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <StackPanel Margin="0"
                          HorizontalAlignment="Left"
                          Orientation="Horizontal"
                          Spacing="6">
                <TextBlock VerticalAlignment="Center" Text="Parent station:" />
                <ComboBox Width="240"
                          VerticalAlignment="Center"
                          ItemsSource="{Binding Stations}"
                          SelectedItem="{Binding SelectedStation}">
                  <ComboBox.ItemTemplate>
                    <DataTemplate>
                      <TextBlock Text="{Binding Name}" ToolTip.Tip="{Binding Name}" />
                    </DataTemplate>
                  </ComboBox.ItemTemplate>
                </ComboBox>
              </StackPanel>
            </Border>

            <Border Grid.Row="1"
                    Grid.Column="0"
                    Padding="0"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <StackPanel Margin="0"
                          HorizontalAlignment="Left"
                          Orientation="Horizontal"
                          Spacing="6">
                <TextBlock Margin="8,0,0,0"
                           VerticalAlignment="Center"
                           Text="Class:" />
                <ComboBox Width="70"
                          VerticalAlignment="Center"
                          ItemsSource="{Binding ShipClassOptions}"
                          SelectedItem="{Binding SelectedShipClass}" />

                <CheckBox Margin="48,0,0,0"
                          Content="With Internal Trades"
                          IsChecked="{Binding WithInternalTrades, Mode=TwoWay}" />
              </StackPanel>
            </Border>
            <Border Grid.Row="2"
                    Grid.Column="0"
                    Padding="0"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <ListBox Width="340"
                       Margin="8"
                       DoubleTapped="ShipGraphsList_DoubleTapped"
                       ItemsSource="{Binding ShipList}">
                <ListBox.ItemTemplate>
                  <DataTemplate>
                    <Grid ColumnDefinitions="*,8,Auto">
                      <TextBlock Grid.Column="0"
                                 FontWeight="{Binding FontWeight}"
                                 Foreground="{Binding GraphBrush, Converter={StaticResource NullToUnsetBrush}}"
                                 Text="{Binding ShipName}"
                                 ToolTip.Tip="{Binding ShipName}" />
                      <TextBlock Grid.Column="2"
                                 Margin="0"
                                 Classes="RightAligned"
                                 FontWeight="SemiBold"
                                 Text="{Binding EstimatedProfit, StringFormat=N2}" />
                    </Grid>
                  </DataTemplate>
                </ListBox.ItemTemplate>
              </ListBox>
            </Border>
            <!--  Filters row  -->
            <Border Grid.Row="3"
                    Grid.Column="0"
                    Padding="0"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <StackPanel Grid.Column="0"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center"
                          Orientation="Horizontal"
                          Spacing="24">
                <StackPanel Orientation="Horizontal" Spacing="12">
                  <RadioButton Margin="8,0,0,0"
                               Content="Name"
                               GroupName="ShipsSort"
                               IsChecked="{Binding ShipsSortOrder, Mode=TwoWay, Converter={StaticResource EnumEquals}, ConverterParameter=Name}" />
                  <RadioButton Margin="8,0,0,0"
                               Content="Profit"
                               GroupName="ShipsSort"
                               IsChecked="{Binding ShipsSortOrder, Mode=TwoWay, Converter={StaticResource EnumEquals}, ConverterParameter=Profit}" />
                </StackPanel>
              </StackPanel>
            </Border>
            <Border Grid.Row="0"
                    Grid.RowSpan="3"
                    Grid.Column="1"
                    Padding="8"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <lvc:CartesianChart Series="{Binding Series}"
                                  XAxes="{Binding XAxes}"
                                  YAxes="{Binding YAxes}" />
            </Border>
          </Grid>
        </TabItem>
        <TabItem x:Name="TradesStatsShipsLoadTab" Header="Ships Load Distribution">
          <Grid DataContext="{Binding TradesStatsShipsLoad}">
            <Grid.RowDefinitions>
              <RowDefinition Height="34" />
              <RowDefinition />
            </Grid.RowDefinitions>
            <Grid Grid.Row="0" ColumnDefinitions="*,Auto">
              <StackPanel Grid.Column="0"
                          Margin="0"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center"
                          Orientation="Horizontal"
                          Spacing="24">
                <CheckBox Content="With Internal Trades" IsChecked="{Binding WithInternalTrades, Mode=TwoWay}" />
              </StackPanel>
              <StackPanel Grid.Column="1"
                          Margin="0"
                          HorizontalAlignment="Right"
                          VerticalAlignment="Center"
                          Orientation="Horizontal"
                          Spacing="8">
                <TextBlock VerticalAlignment="Center" Text="Parent station:" />
                <ComboBox Width="240"
                          VerticalAlignment="Center"
                          ItemsSource="{Binding Stations}"
                          SelectedItem="{Binding SelectedStation}">
                  <ComboBox.ItemTemplate>
                    <DataTemplate>
                      <TextBlock Text="{Binding Name}" ToolTip.Tip="{Binding Name}" />
                    </DataTemplate>
                  </ComboBox.ItemTemplate>
                </ComboBox>
                <TextBlock VerticalAlignment="Center" Text="Class:" />
                <ComboBox Width="70"
                          ItemsSource="{Binding ShipClassOptions}"
                          SelectedItem="{Binding SelectedShipClass}" />
                <TextBlock VerticalAlignment="Center" Text="Top N Ships:" />
                <ComboBox ItemsSource="{Binding TopNOptions}" SelectedItem="{Binding TopN}" />
                <CheckBox VerticalAlignment="Center"
                          Content="Reverse Order"
                          IsChecked="{Binding ReverseSort}" />
              </StackPanel>
            </Grid>
            <Grid Grid.Row="1"
                  ColumnDefinitions="340,*"
                  RowDefinitions="*,34">
              <!--  Sidebar  -->
              <Border Grid.Row="0"
                      Grid.Column="0"
                      Width="340"
                      Padding="0"
                      BorderBrush="Gray"
                      BorderThickness="0">
                <Grid ColumnDefinitions="12,168,8,140,12" RowDefinitions="36,Auto,*">
                  <TextBlock Grid.Row="0"
                             Grid.Column="0"
                             Grid.ColumnSpan="5"
                             HorizontalAlignment="Center"
                             FontWeight="Bold"
                             Text="Selected Ship:" />
                  <TextBlock Grid.Row="1"
                             Grid.Column="1"
                             FontWeight="SemiBold"
                             Text="{Binding PressedShipName}"
                             ToolTip.Tip="{Binding PressedShipName}" />
                  <TextBlock Grid.Row="1"
                             Grid.Column="3"
                             Classes="RightAligned"
                             FontWeight="Bold"
                             Text="{Binding PressedShipTotal}" />
                  <ListBox Grid.Row="2"
                           Grid.Column="0"
                           Grid.ColumnSpan="5"
                           BorderThickness="0"
                           ItemsSource="{Binding ShipBucketsList}">
                    <ListBox.Styles>
                      <Style Selector="ListBoxItem">
                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                      </Style>
                    </ListBox.Styles>
                    <ListBox.ItemTemplate>
                      <DataTemplate>
                        <Grid ColumnDefinitions="4,168,8,140,4">
                          <TextBlock Grid.Column="1"
                                     Margin="0"
                                     FontWeight="{Binding FontWeight}"
                                     Foreground="{Binding GraphBrush, Converter={StaticResource NullToUnsetBrush}}"
                                     Text="{Binding Name}" />
                          <TextBlock Grid.Column="3"
                                     Margin="0"
                                     Classes="RightAligned"
                                     FontWeight="Bold"
                                     Foreground="{Binding GraphBrush, Converter={StaticResource NullToUnsetBrush}}"
                                     Text="{Binding Percent, StringFormat=N2}%" />
                        </Grid>
                      </DataTemplate>
                    </ListBox.ItemTemplate>
                  </ListBox>
                </Grid>
              </Border>
              <!--  Chart  -->
              <Border Grid.Row="0"
                      Grid.Column="1"
                      Padding="8"
                      BorderBrush="Gray"
                      BorderThickness="0">
                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                  <Border MinWidth="{Binding ChartMinWidth}">
                    <lvc:CartesianChart x:Name="TradesShipsLoadChart"
                                        LegendPosition="Hidden"
                                        Sections="{Binding Sections}"
                                        Series="{Binding Series}"
                                        TooltipPosition="{Binding ShowToolTip, Converter={StaticResource BoolToChartPos}}"
                                        XAxes="{Binding XAxes}"
                                        YAxes="{Binding YAxes}" />
                  </Border>
                </ScrollViewer>
              </Border>
              <Border Grid.Row="1"
                      Grid.Column="0"
                      Padding="0"
                      BorderBrush="Gray"
                      BorderThickness="0">
                <StackPanel HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Orientation="Horizontal"
                            Spacing="24">
                  <TextBlock Margin="0,0,8,0"
                             VerticalAlignment="Center"
                             Text="Display Tooltip:" />
                  <CheckBox VerticalAlignment="Center" IsChecked="{Binding ShowToolTip}" />
                </StackPanel>
              </Border>
            </Grid>
          </Grid>
        </TabItem>
        <TabItem x:Name="TradesStatsShipsWaresTab" Header="Ships by Wares Stats">
          <Grid DataContext="{Binding TradesStatsShipsWares}">
            <Grid.RowDefinitions>
              <RowDefinition Height="34" />
              <RowDefinition />
            </Grid.RowDefinitions>
            <!--  Filters row  -->
            <Border Grid.Row="0"
                    Padding="4"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <Grid Grid.ColumnDefinitions="*,Auto">
                <Border Grid.Row="0"
                        Grid.Column="0"
                        Padding="4"
                        BorderBrush="Gray"
                        BorderThickness="0">
                  <StackPanel Grid.Column="0"
                              HorizontalAlignment="Center"
                              Orientation="Horizontal"
                              Spacing="24">
                    <StackPanel Orientation="Horizontal" Spacing="12">
                      <CheckBox Content="With Internal Trades" IsChecked="{Binding WithInternalTrades, Mode=TwoWay}" />
                    </StackPanel>
                  </StackPanel>
                </Border>
                <StackPanel Grid.Column="1"
                            Margin="0"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            Orientation="Horizontal"
                            Spacing="8">
                  <TextBlock VerticalAlignment="Center" Text="Parent station:" />
                  <ComboBox Width="240"
                            VerticalAlignment="Center"
                            ItemsSource="{Binding Stations}"
                            SelectedItem="{Binding SelectedStation}">
                    <ComboBox.ItemTemplate>
                      <DataTemplate>
                        <TextBlock Text="{Binding Name}" ToolTip.Tip="{Binding Name}" />
                      </DataTemplate>
                    </ComboBox.ItemTemplate>
                  </ComboBox>
                  <TextBlock VerticalAlignment="Center" Text="Class:" />
                  <ComboBox Width="70"
                            ItemsSource="{Binding ShipClassOptions}"
                            SelectedItem="{Binding SelectedShipClass}" />
                  <TextBlock VerticalAlignment="Center" Text="Top N Ships:" />
                  <ComboBox ItemsSource="{Binding TopNOptions}" SelectedItem="{Binding TopN}" />
                  <CheckBox VerticalAlignment="Center"
                            Content="Reverse Order"
                            IsChecked="{Binding ReverseSort}" />
                </StackPanel>
              </Grid>
            </Border>
            <!--  Chart + custom legend  -->
            <Grid Grid.Row="1"
                  ColumnDefinitions="340, *"
                  RowDefinitions="Auto,*,34">
              <Border Grid.Row="0"
                      Grid.Column="0"
                      Width="340"
                      Padding="0"
                      BorderBrush="Gray"
                      BorderThickness="0">
                <Grid ColumnDefinitions="12,168,8,140,12" RowDefinitions="36, Auto">
                  <TextBlock Grid.Row="0"
                             Grid.Column="0"
                             Grid.ColumnSpan="5"
                             HorizontalAlignment="Center"
                             FontWeight="Bold"
                             Text="Selected Ship:" />
                  <TextBlock Grid.Row="1"
                             Grid.Column="1"
                             FontWeight="SemiBold"
                             Text="{Binding PressedShipName}"
                             ToolTip.Tip="{Binding PressedShipName}" />
                  <TextBlock Grid.Row="1"
                             Grid.Column="3"
                             Classes="RightAligned"
                             FontWeight="Bold"
                             Text="{Binding PressedShipTotal}" />
                </Grid>
              </Border>
              <Border Grid.Row="1"
                      Grid.Column="0"
                      Padding="4"
                      BorderBrush="Gray"
                      BorderThickness="0">
                <ListBox Width="340"
                         Margin="0"
                         Background="Transparent"
                         ItemsSource="{Binding ShipWaresList}">
                  <ListBox.ItemTemplate>
                    <DataTemplate>
                      <Grid ColumnDefinitions="*,8,Auto">
                        <TextBlock Grid.Column="0"
                                   FontWeight="SemiBold"
                                   Foreground="{Binding GraphBrush, Converter={StaticResource NullToUnsetBrush}}"
                                   Text="{Binding Name}"
                                   ToolTip.Tip="{Binding Name}" />
                        <TextBlock Grid.Column="2"
                                   Margin="0"
                                   Classes="RightAligned"
                                   FontWeight="Bold"
                                   Foreground="{Binding GraphBrush, Converter={StaticResource NullToUnsetBrush}}"
                                   Text="{Binding Money, StringFormat=N2}" />
                      </Grid>
                    </DataTemplate>
                  </ListBox.ItemTemplate>
                </ListBox>
              </Border>
              <Border Grid.Row="2"
                      Grid.Column="0"
                      Padding="0"
                      BorderBrush="Gray"
                      BorderThickness="0">
                <StackPanel HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Orientation="Horizontal"
                            Spacing="24">
                  <TextBlock Margin="0,0,8,0"
                             VerticalAlignment="Center"
                             Text="Display Tooltip:" />
                  <CheckBox VerticalAlignment="Center" IsChecked="{Binding ShowToolTip}" />
                </StackPanel>
              </Border>
              <Border Grid.Row="0"
                      Grid.RowSpan="3"
                      Grid.Column="1"
                      Padding="8"
                      BorderBrush="Gray"
                      BorderThickness="0">
                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                  <Border MinWidth="{Binding ChartMinWidth}">
                    <lvc:CartesianChart x:Name="TradesShipsByWaresChart"
                                        Grid.Column="0"
                                        LegendPosition="Hidden"
                                        Sections="{Binding Sections}"
                                        Series="{Binding Series}"
                                        TooltipPosition="{Binding ShowToolTip, Converter={StaticResource BoolToChartPos}}"
                                        XAxes="{Binding XAxes}"
                                        YAxes="{Binding YAxes}" />
                  </Border>
                </ScrollViewer>
              </Border>
            </Grid>
          </Grid>
        </TabItem>
        <TabItem x:Name="TradesStatsWaresShipsTab" Header="Wares by Ships Stats">
          <Grid DataContext="{Binding TradesStatsWaresShips}">
            <Grid.RowDefinitions>
              <RowDefinition Height="34" />
              <RowDefinition />
            </Grid.RowDefinitions>
            <!--  Filters row  -->
            <Border Grid.Row="0"
                    Padding="4"
                    BorderBrush="Gray"
                    BorderThickness="0">
              <Grid Grid.ColumnDefinitions="*,Auto">
                <Border Grid.Row="0"
                        Grid.Column="0"
                        Padding="4"
                        BorderBrush="Gray"
                        BorderThickness="0">
                  <StackPanel Grid.Column="0"
                              HorizontalAlignment="Center"
                              Orientation="Horizontal"
                              Spacing="24">
                    <StackPanel Orientation="Horizontal" Spacing="12">
                      <CheckBox Content="With Internal Trades" IsChecked="{Binding WithInternalTrades, Mode=TwoWay}" />
                    </StackPanel>
                  </StackPanel>
                </Border>
                <StackPanel Grid.Column="1"
                            Margin="0"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            Orientation="Horizontal"
                            Spacing="8">
                  <TextBlock VerticalAlignment="Center" Text="Parent station:" />
                  <ComboBox Width="240"
                            VerticalAlignment="Center"
                            ItemsSource="{Binding Stations}"
                            SelectedItem="{Binding SelectedStation}">
                    <ComboBox.ItemTemplate>
                      <DataTemplate>
                        <TextBlock Text="{Binding Name}" ToolTip.Tip="{Binding Name}" />
                      </DataTemplate>
                    </ComboBox.ItemTemplate>
                  </ComboBox>
                  <TextBlock VerticalAlignment="Center" Text="Class:" />
                  <ComboBox Width="70"
                            ItemsSource="{Binding ShipClassOptions}"
                            SelectedItem="{Binding SelectedShipClass}" />
                  <TextBlock VerticalAlignment="Center" Text="Top N Wares:" />
                  <ComboBox ItemsSource="{Binding TopNOptions}" SelectedItem="{Binding TopN}" />
                  <CheckBox VerticalAlignment="Center"
                            Content="Reverse Order"
                            IsChecked="{Binding ReverseSort}" />
                </StackPanel>
              </Grid>
            </Border>
            <!--  Chart + custom legend  -->
            <Grid Grid.Row="1"
                  ColumnDefinitions="340, *"
                  RowDefinitions="Auto,*,34">
              <Border Grid.Row="0"
                      Grid.Column="0"
                      Width="340"
                      Padding="0"
                      BorderBrush="Gray"
                      BorderThickness="0">
                <Grid ColumnDefinitions="12,168,8,140,12" RowDefinitions="36, Auto">
                  <TextBlock Grid.Row="0"
                             Grid.Column="0"
                             Grid.ColumnSpan="5"
                             HorizontalAlignment="Center"
                             FontWeight="Bold"
                             Text="Selected Ware:" />
                  <TextBlock Grid.Row="1"
                             Grid.Column="1"
                             FontWeight="SemiBold"
                             Text="{Binding PressedWareName}"
                             ToolTip.Tip="{Binding PressedWareName}" />
                  <TextBlock Grid.Row="1"
                             Grid.Column="3"
                             Classes="RightAligned"
                             FontWeight="Bold"
                             Text="{Binding PressedWareTotal}" />
                </Grid>
              </Border>
              <Border Grid.Row="1"
                      Grid.Column="0"
                      Padding="4"
                      BorderBrush="Gray"
                      BorderThickness="0">
                <ListBox Width="340"
                         Margin="0"
                         Background="Transparent"
                         ItemsSource="{Binding WareShipsList}">
                  <ListBox.ItemTemplate>
                    <DataTemplate>
                      <Grid ColumnDefinitions="*,8,Auto">
                        <TextBlock Grid.Column="0"
                                   FontWeight="SemiBold"
                                   Foreground="{Binding GraphBrush, Converter={StaticResource NullToUnsetBrush}}"
                                   Text="{Binding ShipName}"
                                   ToolTip.Tip="{Binding ShipName}" />
                        <TextBlock Grid.Column="2"
                                   Margin="0"
                                   Classes="RightAligned"
                                   FontWeight="Bold"
                                   Foreground="{Binding GraphBrush, Converter={StaticResource NullToUnsetBrush}}"
                                   Text="{Binding EstimatedProfit, StringFormat=N2}" />
                      </Grid>
                    </DataTemplate>
                  </ListBox.ItemTemplate>
                </ListBox>
              </Border>
              <Border Grid.Row="2"
                      Grid.Column="0"
                      Padding="0"
                      BorderBrush="Gray"
                      BorderThickness="0">
                <StackPanel HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Orientation="Horizontal"
                            Spacing="24">
                  <TextBlock Margin="0,0,8,0"
                             VerticalAlignment="Center"
                             Text="Display Tooltip:" />
                  <CheckBox VerticalAlignment="Center" IsChecked="{Binding ShowToolTip}" />
                </StackPanel>
              </Border>
              <Border Grid.Row="0"
                      Grid.RowSpan="3"
                      Grid.Column="1"
                      Padding="8"
                      BorderBrush="Gray"
                      BorderThickness="0">
                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                  <Border MinWidth="{Binding ChartMinWidth}">
                    <lvc:CartesianChart x:Name="TradesWaresByShipsChart"
                                        Grid.Column="0"
                                        LegendPosition="Hidden"
                                        Sections="{Binding Sections}"
                                        Series="{Binding Series}"
                                        TooltipPosition="{Binding ShowToolTip, Converter={StaticResource BoolToChartPos}}"
                                        XAxes="{Binding XAxes}"
                                        YAxes="{Binding YAxes}" />
                  </Border>
                </ScrollViewer>
              </Border>
            </Grid>
          </Grid>
        </TabItem>
      </TabControl>
    </TabItem>
    <TabItem x:Name="ConfigurationTab" Header="Configuration">
      <Grid Margin="12" DataContext="{Binding Configuration}">
        <Grid.RowDefinitions>
          <!--  0: Game folder row  -->
          <RowDefinition Height="Auto" />
          <!--  1: gap  -->
          <RowDefinition Height="8" />
          <!--  2: Game-data statistics row  -->
          <RowDefinition Height="Auto" />
          <!--  3: big separation  -->
          <RowDefinition Height="32" />
          <!--  4: Game save path row  -->
          <RowDefinition Height="Auto" />
          <!--  5: gap  -->
          <RowDefinition Height="8" />
          <!--  6: Auto reload game save row  -->
          <RowDefinition Height="Auto" />
          <!--  7: Save-data statistics row  -->
          <RowDefinition Height="Auto" />
          <!--  8: gap  -->
          <RowDefinition Height="8" />
          <!--  9: Theme selector row  -->
          <RowDefinition Height="Auto" />
          <!--  10: gap before debug options  -->
          <RowDefinition Height="8" />
          <!--  11: debug options row  -->
          <RowDefinition Height="Auto" />
          <!--  12: gap before update info  -->
          <RowDefinition Height="8" />
          <!--  13: Update info gap  -->
          <RowDefinition Height="8" />
          <!--  14: Update checker row  -->
          <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="160" />
          <ColumnDefinition Width="*" />
          <ColumnDefinition Width="Auto" />
          <ColumnDefinition Width="12" />
          <ColumnDefinition Width="Auto" />
          <ColumnDefinition Width="12" />
          <ColumnDefinition Width="Auto" />
          <ColumnDefinition Width="12" />
          <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>

        <!--  0: Game Folder (X4.exe)  -->
        <TextBlock Grid.Row="0"
                   Grid.Column="0"
                   VerticalAlignment="Center"
                   Text="Game Folder" />
        <TextBlock Grid.Row="0"
                   Grid.Column="1"
                   VerticalAlignment="Center"
                   Text="{Binding GameFolderExePath}"
                   TextTrimming="CharacterEllipsis" />
        <Button Grid.Row="0"
                Grid.Column="2"
                Click="SetGameFolder_Click"
                Content="Set" />
        <CheckBox Grid.Row="0"
                  Grid.Column="4"
                  VerticalAlignment="Center"
                  Content="Load Only Game Language"
                  IsChecked="{Binding LoadOnlyGameLanguage, Mode=TwoWay}" />
        <Button Grid.Row="0"
                Grid.Column="6"
                Click="ReloadGameData_Click"
                Content="Load Game Data"
                IsEnabled="{Binding CanReloadGameData}" />

        <!--  2: Game-data statistics (each stat on its own line)  -->
        <Border Grid.Row="2"
                Grid.ColumnSpan="7"
                Padding="8,0,0,8"
                BorderBrush="Gray"
                BorderThickness="0,0,0,1">
          <StackPanel Orientation="Vertical" Spacing="6">
            <StackPanel Orientation="Horizontal" Spacing="6">
              <TextBlock Text="Languages:" />
              <TextBlock FontWeight="Bold"
                         Foreground="{Binding LanguagesCount, Converter={StaticResource ZeroToRed}}"
                         Text="{Binding LanguagesCount}" />
            </StackPanel>
            <StackPanel Orientation="Horizontal" Spacing="6">
              <TextBlock Foreground="{Binding CurrentLanguageTextCount, Converter={StaticResource ZeroToRed}}" Text="Texts ( " />
              <TextBlock Text="Language Id: " />
              <TextBlock FontWeight="Bold"
                         Foreground="{Binding CurrentLanguageId, Converter={StaticResource ZeroToRed}}"
                         Text="{Binding CurrentLanguageId}" />
              <TextBlock Foreground="{Binding CurrentLanguageTextCount, Converter={StaticResource ZeroToRed}}" Text="):" />
              <TextBlock FontWeight="Bold"
                         Foreground="{Binding CurrentLanguageTextCount, Converter={StaticResource ZeroToRed}}"
                         Text="{Binding CurrentLanguageTextCount}" />
            </StackPanel>
            <StackPanel Orientation="Horizontal" Spacing="6">
              <TextBlock Foreground="{Binding WaresCount, Converter={StaticResource ZeroToRed}}" Text="Wares:" />
              <TextBlock FontWeight="Bold"
                         Foreground="{Binding WaresCount, Converter={StaticResource ZeroToRed}}"
                         Text="{Binding WaresCount}" />
            </StackPanel>
            <StackPanel Orientation="Horizontal" Spacing="6">
              <TextBlock Foreground="{Binding FactionsCount, Converter={StaticResource ZeroToRed}}" Text="Factions:" />
              <TextBlock FontWeight="Bold"
                         Foreground="{Binding FactionsCount, Converter={StaticResource ZeroToRed}}"
                         Text="{Binding FactionsCount}" />
            </StackPanel>
            <StackPanel Orientation="Horizontal" Spacing="6">
              <TextBlock Foreground="{Binding ClusterSectorNamesCount, Converter={StaticResource ZeroToRed}}" Text="Cluster/Sector names:" />
              <TextBlock FontWeight="Bold"
                         Foreground="{Binding ClusterSectorNamesCount, Converter={StaticResource ZeroToRed}}"
                         Text="{Binding ClusterSectorNamesCount}" />
            </StackPanel>
            <StackPanel Orientation="Horizontal" Spacing="6">
              <TextBlock Foreground="{Binding StoragesCount, Converter={StaticResource ZeroToRed}}" Text="Storages:" />
              <TextBlock FontWeight="Bold"
                         Foreground="{Binding StoragesCount, Converter={StaticResource ZeroToRed}}"
                         Text="{Binding StoragesCount}" />
            </StackPanel>
            <StackPanel Orientation="Horizontal" Spacing="6">
              <TextBlock Foreground="{Binding ShipStoragesCount, Converter={StaticResource ZeroToRed}}" Text="Ship storages:" />
              <TextBlock FontWeight="Bold"
                         Foreground="{Binding ShipStoragesCount, Converter={StaticResource ZeroToRed}}"
                         Text="{Binding ShipStoragesCount}" />
            </StackPanel>
            <StackPanel Orientation="Horizontal" Spacing="6">
              <TextBlock Foreground="{Binding ShipTypesCount, Converter={StaticResource ZeroToRed}}" Text="Ship types:" />
              <TextBlock FontWeight="Bold"
                         Foreground="{Binding ShipTypesCount, Converter={StaticResource ZeroToRed}}"
                         Text="{Binding ShipTypesCount}" />
            </StackPanel>
          </StackPanel>
        </Border>

        <!--  4: Game Save Path  -->
        <TextBlock Grid.Row="4"
                   Grid.Column="0"
                   VerticalAlignment="Center"
                   Text="Game Save Path" />
        <TextBlock Grid.Row="4"
                   Grid.Column="1"
                   VerticalAlignment="Center"
                   Text="{Binding GameSavePath}"
                   TextTrimming="CharacterEllipsis" />
        <Button Grid.Row="4"
                Grid.Column="2"
                Click="SetSaveFolder_Click"
                Content="Set" />
        <CheckBox Grid.Row="4"
                  Grid.Column="4"
                  VerticalAlignment="Center"
                  Content="Load removed objects"
                  IsChecked="{Binding LoadRemovedObjects, Mode=TwoWay}" />
        <Button Grid.Row="4"
                Grid.Column="6"
                Click="ReloadSaveData_Click"
                Content="Load Save Data"
                IsEnabled="{Binding CanReloadSaveData}" />

        <!--  6: Auto reload game save selection  -->
        <StackPanel Grid.Row="6"
                    Grid.ColumnSpan="7"
                    Margin="0,0,0,4"
                    Orientation="Horizontal"
                    Spacing="12">
          <TextBlock VerticalAlignment="Center" Text="Auto reload game save:" />
          <RadioButton Content="No"
                       GroupName="AutoReloadSaveMode"
                       IsChecked="{Binding AutoReloadNone}" />
          <RadioButton Content="Selected Save file"
                       GroupName="AutoReloadSaveMode"
                       IsChecked="{Binding AutoReloadSelectedFile}" />
          <RadioButton Content="Any Save file"
                       GroupName="AutoReloadSaveMode"
                       IsChecked="{Binding AutoReloadAnyFile}" />
        </StackPanel>

        <!--  7: Save-data statistics (each stat on its own line)  -->
        <Border Grid.Row="7"
                Grid.ColumnSpan="7"
                Padding="8,0,0,8"
                BorderBrush="Gray"
                BorderThickness="0,0,0,1">
          <StackPanel Orientation="Vertical" Spacing="6">
            <StackPanel Orientation="Horizontal" Spacing="6">
              <TextBlock Foreground="{Binding PlayerShipsCount, Converter={StaticResource ZeroToRed}}" Text="Player ships:" />
              <TextBlock FontWeight="Bold"
                         Foreground="{Binding PlayerShipsCount, Converter={StaticResource ZeroToRed}}"
                         Text="{Binding PlayerShipsCount}" />
            </StackPanel>
            <StackPanel Orientation="Horizontal" Spacing="6">
              <TextBlock Foreground="{Binding StationsCount, Converter={StaticResource ZeroToRed}}" Text="Stations:" />
              <TextBlock FontWeight="Bold"
                         Foreground="{Binding StationsCount, Converter={StaticResource ZeroToRed}}"
                         Text="{Binding StationsCount}" />
            </StackPanel>
            <StackPanel Orientation="Horizontal" Spacing="6">
              <TextBlock Foreground="{Binding GatesCount, Converter={StaticResource ZeroToRed}}" Text="Gates Connections:" />
              <TextBlock FontWeight="Bold"
                         Foreground="{Binding GatesCount, Converter={StaticResource ZeroToRed}}"
                         Text="{Binding GatesCount}" />
            </StackPanel>
            <StackPanel Orientation="Horizontal" Spacing="6">
              <TextBlock Text="Removed objects:">
                <TextBlock.Foreground>
                  <MultiBinding Converter="{StaticResource ZeroToRedIfEnabled}">
                    <Binding Path="RemovedObjectCount" />
                    <Binding Path="LoadRemovedObjects" />
                  </MultiBinding>
                </TextBlock.Foreground>
              </TextBlock>
              <TextBlock FontWeight="Bold" Text="{Binding RemovedObjectCount}">
                <TextBlock.Foreground>
                  <MultiBinding Converter="{StaticResource ZeroToRedIfEnabled}">
                    <Binding Path="RemovedObjectCount" />
                    <Binding Path="LoadRemovedObjects" />
                  </MultiBinding>
                </TextBlock.Foreground>
              </TextBlock>
            </StackPanel>
            <StackPanel Orientation="Horizontal" Spacing="6">
              <TextBlock Foreground="{Binding TradesCount, Converter={StaticResource ZeroToRed}}" Text="Trades:" />
              <TextBlock FontWeight="Bold"
                         Foreground="{Binding TradesCount, Converter={StaticResource ZeroToRed}}"
                         Text="{Binding TradesCount}" />
            </StackPanel>
            <StackPanel Orientation="Horizontal" Spacing="6">
              <TextBlock Text="Subordinate connections:" />
              <TextBlock FontWeight="Bold" Text="{Binding SubordinateCount}" />
            </StackPanel>
          </StackPanel>
        </Border>

        <!--  8: Theme selector  -->
        <TextBlock Grid.Row="9"
                   Grid.Column="0"
                   VerticalAlignment="Center"
                   Text="Theme" />
        <ComboBox Grid.Row="9"
                  Grid.Column="1"
                  Width="200"
                  SelectedItem="{Binding AppTheme, Mode=TwoWay}">
          <x:String>System</x:String>
          <x:String>Light</x:String>
          <x:String>Dark</x:String>
        </ComboBox>
        <StackPanel Grid.Row="11"
                    Grid.Column="0"
                    Grid.ColumnSpan="9"
                    VerticalAlignment="Center"
                    Orientation="Horizontal"
                    Spacing="16">
          <CheckBox VerticalAlignment="Center"
                    Content="Write log file"
                    IsChecked="{Binding EnableFileLogging, Mode=TwoWay}" />
          <CheckBox VerticalAlignment="Center"
                    Content="Include Avalonia logs"
                    IsChecked="{Binding IncludeAvaloniaLogs, Mode=TwoWay}" />
          <StackPanel VerticalAlignment="Center"
                      Orientation="Horizontal"
                      Spacing="6">
            <TextBlock VerticalAlignment="Center" Text="Minimum log level" />
            <ComboBox Width="150"
                      ItemsSource="{Binding LogLevels}"
                      SelectedItem="{Binding MinimumLogLevel, Mode=TwoWay}" />
          </StackPanel>
        </StackPanel>

        <Border Grid.Row="12"
                Grid.ColumnSpan="7"
                Padding="8,0,0,8"
                BorderBrush="Gray"
                BorderThickness="0,0,0,1" />

        <!--  10: Update checker row  -->
        <TextBlock Grid.Row="14"
                   Grid.Column="0"
                   VerticalAlignment="Center"
                   Text="Version:" />
        <StackPanel Grid.Row="14"
                    Grid.Column="1"
                    VerticalAlignment="Center"
                    Orientation="Horizontal"
                    Spacing="6">
          <TextBlock Text="Current:" />
          <TextBlock FontWeight="Bold" Text="{Binding CurrentVersion}" />
          <TextBlock Text="Latest published:" />
          <TextBlock FontWeight="Bold" Text="{Binding LastCheckedRemoteVersion}" />
        </StackPanel>
        <CheckBox Grid.Row="14"
                  Grid.Column="4"
                  VerticalAlignment="Center"
                  Content="Check for updates on startup"
                  IsChecked="{Binding CheckForUpdatesOnStartup, Mode=TwoWay}" />
        <Button Grid.Row="14"
                Grid.Column="6"
                VerticalAlignment="Center"
                Click="CheckForUpdates_Click"
                Content="Check for updates"
                IsEnabled="{Binding CanCheckForUpdates}" />
      </Grid>
    </TabItem>

    <TabItem x:Name="ReadmeTab" Header="Readme">
      <Grid>
        <ScrollViewer x:Name="ReadmeScrollViewer"
                      Margin="8"
                      VerticalScrollBarVisibility="Auto" />
      </Grid>
    </TabItem>
  </TabControl>
</Window>
